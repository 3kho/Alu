---
import { STATIC_PATHS } from "@i18n/utils";
import Layout from "src/layouts/Layout.astro";
import marketplace from "../../json/marketplace.json";

export const getStaticPaths = () => {
  return STATIC_PATHS;
};

type MarketplaceItem = {
  title: string;
  version: string;
  image: string;
  script: string;
  type: string;
  entryNamespace?: string;
  entryFunc?: string;
  themeName?: string;
};
---

<Layout title="Marketplace | Alu">
  <div id="main-content">
    <h1 class="title-text">Marketplace</h1>
    <p class="title-desc">(WIP) Install custom extensions for Alu!</p>
    <div id="support-warning"></div>
    <div class="marketplace-ext-grid">
      {
        Object.keys(marketplace).map((mp_item) => {
          const item = (marketplace as { [key: string]: MarketplaceItem })[mp_item];
          const slug = mp_item;
          return (
            <div class="marketplace-item" data-slug={slug}>
              <img class="marketplace-item-image" src={item.image} alt={`${item.title} Logo`} />
              <div class="marketplace-item-title">{item.title}</div>
              <button class="marketplace-btn btn-install" data-slug={slug} data-title={item.title}>
                Install
              </button>
              <button class="marketplace-btn btn-hidden" data-uninstall-slug={slug}>
                Uninstall
              </button>
            </div>
          );
        })
      }
    </div>
  </div>
  <script src="@components/ts/marketplace.ts"></script>
</Layout>

<style>
  .title-desc {
    font-size: 1.2rem;
  }
  .marketplace-ext-grid {
    display: grid;
    width: 90%;
    margin: 0 auto;
    color: var(--text-color);
    display: grid;
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    text-align: center;
    justify-content: center;
    gap: 20px;
  }
  .marketplace-item {
    border: 3px solid var(--accent-color);
    padding: 20px;
    border-radius: 15px;
    width: 180px;
  }
  .marketplace-item-image {
    width: 64px;
    height: 64px;
  }
  .marketplace-btn {
    width: 100%;
    background-color: var(--accent-color);
    color: var(--text-color);
    border: none;
    margin-top: 3px;
    padding: 3px;
    cursor: pointer;
    font-family: "Varela Round", sans-serif;
    border-radius: 15px;
    margin-top: 10px;
    transition: 250ms ease-in-out;
  }
  .marketplace-btn.installed {
    filter: brightness(0.8);
    cursor: auto;
  }
  #support-warning {
    padding-top: 10px;
    padding-bottom: 50px;
    height: 20px;
    color: #ff6923;
    text-align: center;
  }
  .btn-hidden {
    opacity: 0;
    pointer-events: none;
  }
</style>
